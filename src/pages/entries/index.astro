---
import BaseLayout from "../../layouts/BaseLayout.astro";
import PolaroidCard from "../../components/PolaroidCard.astro";
import RansomTitle from "../../components/RansomTitle.astro";
import { getCollection } from "astro:content";
import { TOPICS } from "../../config/topics";

const posts = (await getCollection("posts"))
  .filter((p) => !p.data.draft)
  .sort((a, b) => +new Date(b.data.pubDate) - +new Date(a.data.pubDate));
---

<BaseLayout title="Entries" description="Archive of scrapbook entries." active="entries">
  <main class="mx-auto max-w-6xl px-5 pb-24 pt-10">
    <section class="paper edge-torn p-6 sm:p-10" data-reveal>
      <div class="kicker text-xs text-black/50">ARCHIVE</div>
      <RansomTitle text="Entries" as="h1" class="text-[44px] sm:text-[56px]" />
      <p class="mt-3 text-black/60">Bấm vào bị ám đấy hí hí :p</p>

      <div class="topic-bar" aria-label="Topics">
        {TOPICS.map((t) => (
          <a class="topic-chip" href={`/topics/${t.slug}`}>{t.label}</a>
        ))}
      </div>
    </section>

    <section class="mt-10">
      <div class="grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3">
        {posts.map((post) => (
          <PolaroidCard
            href={`/entries/${post.slug}`}
            title={post.data.title}
            date={post.data.pubDate}
            imageSrc={post.data.cover}
          />
        ))}
      </div>
    </section>
  </main>
</BaseLayout>
